19:34:44   Note: NumExpr detected 16 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
19:34:44   NumExpr defaulting to 8 threads.
19:34:44   Config file: config/inductive/fb15k237_oracle2.yaml
19:34:44   {'checkpoint': '~/experiments/InductiveKnowledgeGraphCompletion/FB15k237Inductive/NBFNet/2025-01-15-16-13-23/model_epoch_8.pth',
 'dataset': {'class': 'FB15k237Inductive',
             'path': '~/datasets/knowledge_graphs/',
             'version': 'v1'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '~/experiments/',
 'task': {'adversarial_temperature': 0.5,
          'class': 'InductiveKnowledgeGraphCompletion',
          'criterion': 'bce',
          'full_batch_eval': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'remove_one_hop': True,
                    'short_cut': True},
          'num_negative': 32,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 0}}
PATH: /home/main/datasets/knowledge_graphs/
TRAIN FILE: /home/main/datasets/knowledge_graphs/grail_sets/train/train.txt
TRAIN FILE: /home/main/datasets/knowledge_graphs/grail_sets/train/valid.txt
TEST FILE: /home/main/datasets/knowledge_graphs/grail_sets/test/train.txt
TEST FILE: /home/main/datasets/knowledge_graphs/grail_sets/test/test.txt
CHECKING: grail_sets/test/test.txt_rels
NO REL FOUND
********************


/home/main/datasets/knowledge_graphs/grail_sets/train/train.txt
/home/main/datasets/knowledge_graphs/grail_sets/train/valid.txt
19:34:44   FB15k237Inductive(
  #entity: 1438
  #relation: 180
  #triplet: 2730
)
19:34:44   #train: 2730, #valid: 489, #test: 1
19:34:44   Preprocess training set
19:34:45   {'batch_size': 64,
 'class': 'core.Engine',
 'focus_train': [],
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'class': 'optim.Adam',
               'eps': 1e-08,
               'lr': 0.005,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.InductiveKnowledgeGraphCompletion',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@10_50'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(180),
                    'path_topk': 10,
                    'remove_one_hop': True,
                    'short_cut': True,
                    'symmetric': False},
          'num_negative': 32,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.FB15k237Inductive',
                          'path': '~/datasets/knowledge_graphs/',
                          'verbose': 1,
                          'version': 'v1'},
              'indices': range(3219, 3220)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.FB15k237Inductive',
                           'path': '~/datasets/knowledge_graphs/',
                           'verbose': 1,
                           'version': 'v1'},
               'indices': range(0, 2730)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.FB15k237Inductive',
                           'path': '~/datasets/knowledge_graphs/',
                           'verbose': 1,
                           'version': 'v1'},
               'indices': range(2730, 3219)}}
19:34:45   Load checkpoint from ~/experiments/InductiveKnowledgeGraphCompletion/FB15k237Inductive/NBFNet/2025-01-15-16-13-23/model_epoch_8.pth
19:34:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:34:45   Evaluate on test
19:35:04   ------------------------------
19:35:04   hits@1: 0.5
19:35:04   hits@10: 0.5
19:35:04   hits@10_50: 0.511331
19:35:04   hits@3: 0.5
19:35:04   mr: 211
19:35:04   mrr: 0.501188
